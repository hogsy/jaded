int		ti_i
int		ti_k

object	to_bone

OBJ_FlagsControlSet(OBJ_C_ControlFlag_AlwaysVisible, none)
ACT_ActionSet(0)

// 0
to_bone = ANI_CanalObjectGet(Anim_Canal_Bassin)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 1
to_bone = ANI_CanalObjectGet(Anim_Canal_Ventre)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 2
to_bone = ANI_CanalObjectGet(Anim_Canal_Torse)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 3
to_bone = ANI_CanalObjectGet(Anim_Canal_Cou)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 4
to_bone = ANI_CanalObjectGet(Anim_Canal_Tete)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 5
to_bone = ANI_CanalObjectGet(Anim_Canal_BrasDroit)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 6
to_bone = ANI_CanalObjectGet(Anim_Canal_AvantBrasDroit)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 7
to_bone = ANI_CanalObjectGet(Anim_Canal_MainDroite)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 8
to_bone = ANI_CanalObjectGet(Anim_Canal_BrasGauche)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 9
to_bone = ANI_CanalObjectGet(Anim_Canal_AvantBrasGauche)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 10
to_bone = ANI_CanalObjectGet(Anim_Canal_MainGauche)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 11
to_bone = ANI_CanalObjectGet(Anim_Canal_CuisseDroite)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 12
to_bone = ANI_CanalObjectGet(Anim_Canal_JambeDroite)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 13
to_bone = ANI_CanalObjectGet(Anim_Canal_PiedDroit)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 14
to_bone = ANI_CanalObjectGet(Anim_Canal_CuisseGauche)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 15
to_bone = ANI_CanalObjectGet(Anim_Canal_JambeGauche)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 16
to_bone = ANI_CanalObjectGet(Anim_Canal_PiedGauche)
ao_modules[i_modules_nb] = to_bone
av_modules_last_pos[i_modules_nb] = @to_bone OBJ_PosGet()
i_modules_nb ++

// 0
ai_modules_neighbour[0][0] = 1
af_modules_length[0][0] = MATH_VecNorm(@ao_modules[0] OBJ_PosGet() - @ao_modules[1] OBJ_PosGet())

ai_modules_neighbour[0][1] = 11
af_modules_length[0][1] = MATH_VecNorm(@ao_modules[0] OBJ_PosGet() - @ao_modules[11] OBJ_PosGet())

ai_modules_neighbour[0][2] = 14
af_modules_length[0][2] = MATH_VecNorm(@ao_modules[0] OBJ_PosGet() - @ao_modules[14] OBJ_PosGet())

ai_modules_neighbour[0][3] = -1

// 1
ai_modules_neighbour[1][0] = 0
af_modules_length[1][0] = MATH_VecNorm(@ao_modules[1] OBJ_PosGet() - @ao_modules[0] OBJ_PosGet())

ai_modules_neighbour[1][1] = 2
af_modules_length[1][1] = MATH_VecNorm(@ao_modules[1] OBJ_PosGet() - @ao_modules[2] OBJ_PosGet())

ai_modules_neighbour[1][2] = -1

// 2
ai_modules_neighbour[2][0] = 1
af_modules_length[2][0]= MATH_VecNorm(@ao_modules[2] OBJ_PosGet() - @ao_modules[1] OBJ_PosGet())

ai_modules_neighbour[2][1] = 3
af_modules_length[2][1] = MATH_VecNorm(@ao_modules[2] OBJ_PosGet() - @ao_modules[3] OBJ_PosGet())

ai_modules_neighbour[2][2] = -1

// 3
ai_modules_neighbour[3][0] = 2
af_modules_length[3][0] = MATH_VecNorm(@ao_modules[3] OBJ_PosGet() - @ao_modules[2] OBJ_PosGet())

ai_modules_neighbour[3][1] = 4
af_modules_length[3][1] = MATH_VecNorm(@ao_modules[3] OBJ_PosGet() - @ao_modules[4] OBJ_PosGet())

ai_modules_neighbour[3][2] = -1

// 4
ai_modules_neighbour[4][0] = 3
af_modules_length[4][0] = MATH_VecNorm(@ao_modules[4] OBJ_PosGet() - @ao_modules[3] OBJ_PosGet())

ai_modules_neighbour[4][1] = -1

// 5
ai_modules_neighbour[5][0] = 3
af_modules_length[5][0] = MATH_VecNorm(@ao_modules[5] OBJ_PosGet() - @ao_modules[3] OBJ_PosGet())

ai_modules_neighbour[5][1] = 11
af_modules_length[5][1] = MATH_VecNorm(@ao_modules[5] OBJ_PosGet() - @ao_modules[11] OBJ_PosGet())

ai_modules_neighbour[5][2] = 6
af_modules_length[5][2] = MATH_VecNorm(@ao_modules[5] OBJ_PosGet() - @ao_modules[6] OBJ_PosGet())

ai_modules_neighbour[5][3] = 8
af_modules_length[5][3] = MATH_VecNorm(@ao_modules[5] OBJ_PosGet() - @ao_modules[8] OBJ_PosGet())

ai_modules_neighbour[5][4] = 14
af_modules_length[5][4] = MATH_VecNorm(@ao_modules[5] OBJ_PosGet() - @ao_modules[14] OBJ_PosGet())

// 6
ai_modules_neighbour[6][0] = 5
af_modules_length[6][0] = MATH_VecNorm(@ao_modules[6] OBJ_PosGet() - @ao_modules[5] OBJ_PosGet())

ai_modules_neighbour[6][1] = 7
af_modules_length[6][1] = MATH_VecNorm(@ao_modules[6] OBJ_PosGet() - @ao_modules[7] OBJ_PosGet())

ai_modules_neighbour[6][2] = -1

// 7
ai_modules_neighbour[7][0] = 6
af_modules_length[7][0] = MATH_VecNorm(@ao_modules[7] OBJ_PosGet() - @ao_modules[6] OBJ_PosGet())

ai_modules_neighbour[7][1] = -1

// 8
ai_modules_neighbour[8][0] = 3
af_modules_length[8][0] = MATH_VecNorm(@ao_modules[8] OBJ_PosGet() - @ao_modules[3] OBJ_PosGet())

ai_modules_neighbour[8][1] = 14
af_modules_length[8][1] = MATH_VecNorm(@ao_modules[8] OBJ_PosGet() - @ao_modules[14] OBJ_PosGet())

ai_modules_neighbour[8][2] = 9
af_modules_length[8][2] = MATH_VecNorm(@ao_modules[8] OBJ_PosGet() - @ao_modules[9] OBJ_PosGet())

ai_modules_neighbour[8][3] = 5
af_modules_length[8][3] = MATH_VecNorm(@ao_modules[8] OBJ_PosGet() - @ao_modules[5] OBJ_PosGet())

ai_modules_neighbour[8][4] = 11
af_modules_length[8][4] = MATH_VecNorm(@ao_modules[8] OBJ_PosGet() - @ao_modules[11] OBJ_PosGet())


// 9
ai_modules_neighbour[9][0] = 8
af_modules_length[9][0] = MATH_VecNorm(@ao_modules[9] OBJ_PosGet() - @ao_modules[8] OBJ_PosGet())

ai_modules_neighbour[9][1] = 10
af_modules_length[9][1] = MATH_VecNorm(@ao_modules[9] OBJ_PosGet() - @ao_modules[10] OBJ_PosGet())

ai_modules_neighbour[9][2] = -1

// 10
ai_modules_neighbour[10][0] = 9
af_modules_length[10][0] = MATH_VecNorm(@ao_modules[10] OBJ_PosGet() - @ao_modules[9] OBJ_PosGet())

ai_modules_neighbour[10][1] = -1

// 11
ai_modules_neighbour[11][0] = 0
af_modules_length[11][0] = MATH_VecNorm(@ao_modules[11] OBJ_PosGet() - @ao_modules[0] OBJ_PosGet())

ai_modules_neighbour[11][1] = 5
af_modules_length[11][1] = MATH_VecNorm(@ao_modules[11] OBJ_PosGet() - @ao_modules[5] OBJ_PosGet())

ai_modules_neighbour[11][2] = 3
af_modules_length[11][2] = MATH_VecNorm(@ao_modules[11] OBJ_PosGet() - @ao_modules[3] OBJ_PosGet())

ai_modules_neighbour[11][3] = 12
af_modules_length[11][3] = MATH_VecNorm(@ao_modules[11] OBJ_PosGet() - @ao_modules[12] OBJ_PosGet())

ai_modules_neighbour[11][4] = 8
af_modules_length[11][4] = MATH_VecNorm(@ao_modules[11] OBJ_PosGet() - @ao_modules[8] OBJ_PosGet())

ai_modules_neighbour[11][4] = -1

// 12
ai_modules_neighbour[12][0] = 11
af_modules_length[12][0] = MATH_VecNorm(@ao_modules[12] OBJ_PosGet() - @ao_modules[11] OBJ_PosGet())

ai_modules_neighbour[12][1] = 13
af_modules_length[12][1] = MATH_VecNorm(@ao_modules[12] OBJ_PosGet() - @ao_modules[13] OBJ_PosGet())

ai_modules_neighbour[12][2] = -1

// 13
ai_modules_neighbour[13][0] = 12
af_modules_length[13][0] = MATH_VecNorm(@ao_modules[13] OBJ_PosGet() - @ao_modules[12] OBJ_PosGet())

ai_modules_neighbour[13][1] = -1

// 14
ai_modules_neighbour[14][0] = 0
af_modules_length[14][0] = MATH_VecNorm(@ao_modules[14] OBJ_PosGet() - @ao_modules[0] OBJ_PosGet())

ai_modules_neighbour[14][1] = 8
af_modules_length[14][1] = MATH_VecNorm(@ao_modules[14] OBJ_PosGet() - @ao_modules[8] OBJ_PosGet())

ai_modules_neighbour[14][2] = 3
af_modules_length[14][2] = MATH_VecNorm(@ao_modules[14] OBJ_PosGet() - @ao_modules[3] OBJ_PosGet())

ai_modules_neighbour[14][3] = 15
af_modules_length[14][3] = MATH_VecNorm(@ao_modules[14] OBJ_PosGet() - @ao_modules[15] OBJ_PosGet())

ai_modules_neighbour[14][4] = 5
af_modules_length[14][4] = MATH_VecNorm(@ao_modules[14] OBJ_PosGet() - @ao_modules[5] OBJ_PosGet())

// 15
ai_modules_neighbour[15][0] = 14
af_modules_length[15][0] = MATH_VecNorm(@ao_modules[15] OBJ_PosGet() - @ao_modules[14] OBJ_PosGet())

ai_modules_neighbour[15][1] = 16
af_modules_length[15][1] = MATH_VecNorm(@ao_modules[15] OBJ_PosGet() - @ao_modules[16] OBJ_PosGet())

ai_modules_neighbour[15][2] = -1

// 16
ai_modules_neighbour[16][0] = 15
af_modules_length[16][0] = MATH_VecNorm(@ao_modules[16] OBJ_PosGet() - @ao_modules[15] OBJ_PosGet())

ai_modules_neighbour[16][1] = -1

for (ti_i = 0; ti_i < i_modules_nb; ti_i++)
{
	ti_k = 0
	while (ti_k < 5 && ai_modules_neighbour[ti_i][ti_k] != -1)
	{
		DBG_RenderVector(av_modules_last_pos[ti_i], av_modules_last_pos[ai_modules_neighbour[ti_i][ti_k]] - av_modules_last_pos[ti_i], color_jaune)
		ti_k++
	}
}


f_rigidity_coef = 200.0

AI_CBAdd(OBJ_Me(), CallBack_After_Blend, "Ragdoll_callback_afterblend")

AI_TrackCurChangeNow("Ragdoll_Loop")