Include_UltraProcedure_Header

#include "KCG_Defines.var"

// if Kong is on our swing, start running
if ( @mo_Kong Proc_KK_Test_Mode( ETAT_Kong_swing_arch ) && ( @mo_Kong Proc_KK_HotSpotGet() == mo_Swing ))
{
	// first run, for a fast reaction to the weight of Kong, do the "run" state
	if ( !mi_IsAtMaxDistance )
	{
		mi_HasKongUsedTheSwing = vrai
		
		// setup a hierarchy with the swing and its closest bone on the swing so it stays with the whole system
		@mo_Swing OBJ_HierarchySet( mo_ClosestBone )
	
		AI_TrackCurChange( "KCG_ETAT_Run" )
	}
	else	// otherwise do the SwingReact state while Kong is swinging after first run
	{
		AI_TrackCurChange( "KCG_ETAT_SwingReact" )
	}
}
else
{
	//once Kong has used the swing and is off it, it should break.
	if ( mi_HasKongUsedTheSwing )
	{
		SpecialFlag_set(i_SF_AlreadyPlayed)
		AI_Execute( "KCG_EXEC_Break" )
		
		AI_TrackCurChange( "KCG_ETAT_ODEActive" )
	}
}