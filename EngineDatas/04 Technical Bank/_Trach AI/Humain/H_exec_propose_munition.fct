// --------------------------------------------------------------------------------------------------------------------------------
#include "H_defines.var"
// --------------------------------------------------------------------------------------------------------------------------------
messageid		tmid_LNK
object			to_serveur
int					ti_rank
int					ti_danger
float				tf_dist
message		EVT_msg_filter
messageid 		EVT_ID
messageid 		tmid_info
vector			tv_temp
int					ti_index
int					ti_ground_ID
int					ti_manual
int					ti_weapon
// --------------------------------------------------------------------------------------------------------------------------------

tmid_LNK = pop
to_serveur = MSG_GlobalGetGao(tmid_LNK, SERVEUR)
ti_index = Humains_GetIndex(to_serveur)

// -----------------------  JIMMY -------------------------------------------------------------------------------------

if(i_id_humain != C_ID_Jimmy) return
if(@"univ" LIFE_HumainEtat[i_id_humain] == Life_ETAT_Agonisant) return

// J'ai de quoi refiler des munitions ?
ti_weapon = @"univ" i_weapon_ID[ti_index]
if(BambouEnMain()) return
if(!@"univ" i_weapon_ammunition_reserve[ti_weapon][i_id_humain]) return

// Trop loin
tf_dist = OBJ_SqrDistHorz(to_serveur)
if(tf_dist > 50 * 50) return

// S'il est en zone dangereuse, je n'y vais pas
if(ZoneDangereuse(@to_serveur OBJ_PosGet())) return

// Si je suis la cible d'une bestiole, je n'y vais pas
if(HasInteret()) return

// Chemin
if(!TIME_Elapsed(f_time_propose_munition, 2)) return
f_time_propose_munition = TIME_Get()
ti_danger = HL_CheminDangereux(@to_serveur OBJ_PosGet())
if(ti_danger == -1) return

LNK_ClientPropose(tmid_LNK, tf_dist)	 