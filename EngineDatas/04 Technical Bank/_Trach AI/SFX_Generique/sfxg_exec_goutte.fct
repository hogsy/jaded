vector	tv_temp
object	to_obj, to_obj1
vector	tv_poshaut, tv_posbas
object	to_cam

if(!@get_global ENV_pluie_encours) return

to_cam = @get_global o_camera
if(TIME_Elapsed(f_time_goutte_ok, 2.0))
{
	@o_goutte OBJ_CapaSet(OBJ_Capa_0, 0)
	if(@o_goutte OBJ_CapaTest(OBJ_Capa_1))
	{
		if(f_time_goutte_ok)
		{
			f_time_goutte_ok = 0
			f_time_goutte = TIME_Get()
		}
		@o_goutte OBJ_FlagInvisibleSet(vrai)
		@o_goutte OBJ_FlagInactiveSet(vrai)
	}
}

if(TIME_Elapsed(f_time_goutte, f_rand_goutte))
{
	tv_temp = @to_cam OBJ_SightGet() * MATH_RandInt(2, 5)
	tv_temp += @to_cam OBJ_HorizonGet() * MATH_RandFloat(-1,  1)
	tv_temp += @to_cam OBJ_PosGet()
	
	to_obj = COL_RayObject_Vector(tv_temp, cvector(0,0,3), all, OBJ_C_IdentityFlag_Anims, Ci_Filter_IdentityFlag, COL_C_Ray_on_visuel)
	if(to_obj)
	{
		tv_poshaut = COL_RayObject_PosGet()
		to_obj1 = COL_RayObject_Vector(tv_temp, cvector(0,0,-3), all, OBJ_C_IdentityFlag_Anims, Ci_Filter_IdentityFlag, COL_C_Ray_on_ColMap_NoCrossable)
		if(to_obj1)
		{
			@o_goutte OBJ_CapaSet(0, OBJ_Capa_0)
			@o_goutte OBJ_FlagInvisibleSet(faux)
			@o_goutte OBJ_FlagInactiveSet(faux)
			tv_posbas = COL_RayObject_PosGet()
			@o_goutte OBJ_PosSet(tv_poshaut)
			@"SFX/SFX_GoutteO" o_goutte des_f_zsol = tv_posbas.z
			f_rand_goutte = MATH_RandFloat(1, 3)
			f_time_goutte = TIME_Get()
			f_time_goutte_ok = TIME_Get()
		}
		else
		{
			f_rand_goutte = 1.0
		}
	}
	else
	{
		f_rand_goutte = 1.0
	}
}