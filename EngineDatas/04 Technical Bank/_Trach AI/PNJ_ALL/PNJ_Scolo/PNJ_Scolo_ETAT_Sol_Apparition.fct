#include "PNJ_Scolo_defines.var"

int			ti_i

int			ti_flag_ok

object	to_Ann

if (i_flag_sortie_etat)
{
	i_flag_sortie_etat = faux
	return
}

if (i_etat_courant != ETAT_Sol_Apparition)
{
	// INTIALISATION
	i_dernier_etat = i_etat_courant
	i_etat_courant = ETAT_Sol_Apparition
	
	if (fct_last_etat)
	{
		i_flag_sortie_etat = vrai
		AI_Execute(fct_last_etat)
	}
	
	fct_last_etat = AI_TrackCurGet()
	
	i_etat_phase = 0

	f_ground_dist = 0.0
	f_delay_until_last_ground_col = 1000.0

	f_time_start_etat = 0.0
}
else
{
	f_time_start_etat += TIME_GetDt()
}
	
// ANALYSE ===============================================================
if (! o_start_wp )
	macro_change_etat("PNJ_Scolo_ETAT_Sol")

AI_Execute("PNJ_Scolo_exec_check_paf")
if (i_flag_paf)
	macro_change_etat("PNJ_Scolo_ETAT_Meurt")

// COMPORTEMENT =========================================================
f_move_speed = move_speed
f_move_length = f_move_speed * TIME_GetDt()
PNJ_Scolo_Position_Set()

if (i_flag_net_end)
{
	f_move_speed = move_speed
	macro_change_etat("PNJ_Scolo_ETAT_Sol")
}