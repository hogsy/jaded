#include "PNJ_Plane_defines.var"

vector		tv_joy_dir

object		to_camera

if (i_flag_sortie_etat)
{
	i_flag_sortie_etat = faux
	return
}


if (i_etat_courant != ETAT_Cine)
{
	// INTIALISATION
	i_dernier_etat = i_etat_courant
	i_etat_courant = ETAT_Cine
	
	if (fct_last_etat)
	{
		i_flag_sortie_etat = vrai
		AI_Execute(fct_last_etat)
	}
	
	fct_last_etat = AI_TrackCurGet()
	
	f_move_dest_speed = o_start_wp.des_float1
	f_move_speed = f_move_dest_speed

	f_time_start_etat = 0.0
}
else
{
	f_time_start_etat += TIME_GetDt()
}
	
// ANALYSE ===============================================================



// COMPORTEMENT =========================================================
if (f_move_speed > f_move_dest_speed)
	f_move_speed -= MATH_FloatMin(f_move_speed - f_move_dest_speed, 10.0 * TIME_GetDt())
else 
	f_move_speed += MATH_FloatMin(f_move_dest_speed - f_move_speed, 10.0 * TIME_GetDt())

f_move_length = f_move_speed * TIME_GetDt()

PNJ_Plane_Position_Set()
PNJ_Plane_Roll()
PNJ_Plane_GFX_Trace()
PNJ_Plane_Helice()
PNJ_Plane_Ailerons()
//PNJ_Plane_Smoke()

PNJ_Plane_DBG_Render_Net()


//if (TEST_DO_CAMERA)
//{
//	to_camera = VIEW_GetObject(0)
//	tv_joy_dir = IO_JoyGetMove1()
//
//	if (MATH_AbsFloat(tv_joy_dir.x) > 0.25)
//		f_angle_Z -= MATH_FloatSign(tv_joy_dir.x) * 2.0 * TIME_GetDt()
//	f_angle_Z = MATH_FloatLimit(f_angle_Z, -2.0, 2.0)
//		
//	if (MATH_AbsFloat(tv_joy_dir.y) > 0.25)
//		f_angle_X -= MATH_FloatSign(tv_joy_dir.y) * 2.0 * TIME_GetDt()
//	f_angle_X = MATH_FloatLimit(f_angle_X, -1.5, 0.25)
//		
//	VIEW_FocaleSet(0, 1.6)
//	@get_Kamera OBJ_FlagInactiveSet(vrai)
//	@get_Kamera OBJ_PosSet(OBJ_PosGet())
//	@get_Kamera OBJ_SightGeneralSet(-OBJ_SightGet(), OBJ_BankingGet())
//	@get_Kamera OBJ_RotateLocalZ(f_angle_Z)
//	@get_Kamera OBJ_RotateLocalX(f_angle_X)
//	@get_Kamera VIEW_AssignObject(0)
//}

