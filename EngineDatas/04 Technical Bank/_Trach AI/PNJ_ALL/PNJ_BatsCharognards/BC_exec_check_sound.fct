#include "BC_defines.var"

messageid		tmid_sound_ID				// ID du message olfactif

int					ti_sound_rank					// rang du message dans la liste

object			to_pere

vector			tv_position

float				tf_distance


ti_sound_rank = -1
for ( 	tmid_sound_ID = MSG_GlobalScan(C_EVENT_TYPE_Sound, &ti_sound_rank);
		MSG_GlobalIsValid(tmid_sound_ID);
		tmid_sound_ID = MSG_GlobalScan(C_EVENT_TYPE_Sound, &ti_sound_rank) )
{
	to_pere = EVENT_PereGet(tmid_sound_ID)
	if( to_pere == OBJ_Me() )
		continue
	
	if( EVENT_FilterGet(tmid_sound_ID) & C_EVENT_FILTER_BatCharognard )
	{
		// c'est le cri d'un bat
		tv_position = EVENT_PositionGet(tmid_sound_ID)
		tf_distance =  MATH_VecNorm( tv_position - OBJ_PosGet() )
		if( tf_distance <= EVENT_SoundSizeGet(tmid_sound_ID) )
		{
			// je l'entend
			i_flag_check_sound_valide = vrai
			o_cible_attaque = o_jack			// TMP !!!!!!
		}
	}
}

