//#include "BC_defines.var"
//
//int					ti_test
//int					ti_envol
//
//messageid		tmid_vision
//
//object			to_actor
//
//
//// SORTIE ETAT ===============================================================
//if (i_sort_etat)
//{
//	i_sort_etat = faux
//	return
//}
//
//// ENTREE ETAT ===============================================================
//if (i_etat_courant != ETAT_Wait_Perche )
//{
//	i_etat_ancien = i_etat_courant
//	i_etat_courant = ETAT_Wait_Perche
//	
//	if (fct_last_etat)
//	{
//		i_sort_etat = vrai
//		AI_Execute(fct_last_etat)
//	}
//	
//	fct_last_etat = AI_TrackCurGet()
//	f_time_start_etat = 0.0
//	
//	ACT_ActionSet(ACTION_Perchee_Attente)
//	
//	DYN_Off()
//	f_perchee_delai_plongeon = Cf_Infinit
//	i_perchee_retour_flag = faux
//	f_perchee_action_time = MATH_RandFloat(0.5, 4.5)
//	i_perchee_fake_attaque = faux
//	
//	BC_DBG_Trace_Etat("etat wait perchee")
//	
//	f_speed = 0.0	// raz speed qd je me racccroche
//}
//else
//{
//	f_time_start_etat += TIME_GetDt()
//	
//	if( f_perchee_delai_plongeon != Cf_Infinit )
//		f_perchee_delai_plongeon -= MATH_FloatMin(f_perchee_delai_plongeon, TIME_GetDt())
//}
//
//i_flag_neck = faux
//
//
//// ANALYSE ===============================================================
//AI_Execute("BC_exec_check_sound")
//
//if( ! o_cible_attaque )
//	AI_Execute("BC_exec_check_shoot")
//
//AI_Execute("BC_exec_check_vision")
//
//
//// COMPORTEMENT =========================================================
//if( ACT_ActionGet() == ACTION_Perchee_Attente )
//{
//	f_perchee_action_time -= MATH_FloatMin(f_perchee_action_time, TIME_GetDt())
//	if( ! f_perchee_action_time )
//	{
//		SND_RequestPlay(Ci_SND_Cri_Presence)
//		f_perchee_action_time = MATH_RandFloat(5.0, 10.0)
//		i_perchee_action_next = 1 - i_perchee_action_next
//		if( i_perchee_action_next )
//			ACT_ActionSet(ACTION_Perchee_Panic)
//		else
//			ACT_ActionSet(ACTION_Perchee_Panic_var)
//	}
//}
//
//if( ACT_ActionGet() == ACTION_Perchee_Panic || ACT_ActionGet() == ACTION_Perchee_Panic_var )
//{
//	if( ACT_ActionFinished() )
//		ACT_ActionSet(ACTION_Perchee_Attente)
//}
//
//
//if( f_perchee_delai_plongeon == Cf_Infinit )
//{
//	// bat passsive...
//	ti_envol = faux
//	if( ! BC_ForceInactive() )
//	{
//		// TEST CADAVRES
//		to_actor = BC_Cadavre_Nearest(faux)
//		if( to_actor )
//		{
//			if( BC_Cadavre_Nouveau_Test(to_actor) )
//			{
//				BC_Cadavre_Nouveau_Select(to_actor)		// marqué comme "visité"
//				BC_Interet_Update(mid_interet_charogne, C_EVENT_InteretStatusAttack, to_actor, tmid_vision)
//				BC_Charognard_Mode_Force()
//				f_perchee_delai_plongeon = MATH_RandFloat(0.0,2.0)		// ne pas toutes décoller en même temps
//			}
//		}
//		
//		if( i_agressive )
//		{
//			// AGRESSIVE -------------------------------------------------------------------------------------
//			if( i_flag_check_sound_valide )
//			{
//				ti_envol = vrai
//				BC_DBG_Trace_Etat("une bat a crié")
//			}
//			if( i_near_shoot_flag )
//			{
//				ti_envol = vrai
//				BC_DBG_Trace_Etat("on a tiré près de moi")
//			}
//			if( o_cible_attaque || BC_Test_Attaque() )
//			{
//				ti_envol = vrai
//				BC_DBG_Trace_Etat("trigger attaque")
//			}
//			if( ti_envol )
//			{
//				f_perchee_delai_plongeon = MATH_RandFloat(0.0,0.75)		// ne pas toutes décoller en même temps
//				if( ! BC_Gao_in_BV(o_cible_attaque, o_zone_activite) )
//				{
//					i_perchee_fake_attaque = vrai		// la bat va se décrocher comme pour attaquer puis se reposer
//					v_fight_fake_position = OBJ_PosGet() + (10 * OBJ_BankingGet() * f_zoom)
//				}
//			}
//		}
//	}
//}
//else
//{
//	// bat en train de se réveiller...
//	if( MATH_FloatNullEpsilon(f_perchee_delai_plongeon) )
//	{
//		if( i_agressive )
//		{
//			// AGRESSIVE -------------------------------------------------------------------------------------
//			if( @get_global f_time_bats_last_plongeon == 0.0 || TIME_Elapsed(@get_global f_time_bats_last_plongeon, f_plongeon_desynchro_time) )
//			{
//				SND_RequestPlay(Ci_SND_Cri_Attack_Loin)
//				AI_Execute("BC_exec_dyn_on")
//				DYN_SpeedSetVector(Cv_NullVector)
//				tmid_vision = EVENT_FindEventPereTarget(C_EVENT_TYPE_Visibility, o_cible_attaque, nobody)
//				if( MSG_GlobalIsValid(tmid_vision) )
//					BC_Seen_Actor_Add(tmid_vision)
//				macro_change_etat("BC_ETAT_Fight_Approche")
//			}
//		}
//		else
//		{
//			// CHAROGNARD -------------------------------------------------------------------------------------
//			if( ! MSG_GlobalIsValid(mid_grab_charogne) )
//			{
//				if( BC_Check_Sang() )
//				{
//					// SOUND
//					if( @get_global f_time_bats_last_plongeon == 0.0 )
//						@get_global i_bat_perchee_plongeon_modulo = 0
//					else if( TIME_Elapsed(@get_global f_time_bats_last_plongeon, 1.0) )
//						@get_global i_bat_perchee_plongeon_modulo = 0
//					
//					if( @get_global i_bat_perchee_plongeon_modulo == 0 )
//					{
//						SND_RequestPlay(Ci_SND_Cri_Attack_Loin)
//						
////						DBG_TraceFloat(TIME_Get())
////						DBG_TraceString(" : ")
////						DBG_TraceObject(OBJ_Me())
////						DBG_TraceString(" crie en plongeant")
////						DBG_TraceEOL()
//					}
////					else
////					{
////						DBG_TraceFloat(TIME_Get())
////						DBG_TraceString(" : ")
////						DBG_TraceObject(OBJ_Me())
////						DBG_TraceString(" NE crie PAS en plongeant")
////						DBG_TraceEOL()
////					}
//					BC_Update_Global_Last_Plongeon_Time()
//					@get_global i_bat_perchee_plongeon_modulo = MATH_Modulo(@get_global i_bat_perchee_plongeon_modulo +1, 3)
//					ACT_ActionSet(i_ACTION_Vol_Standard)
//					ACT_ActionFrameSet(0, MATH_RandInt(0, 64))
//					macro_change_etat("BC_ETAT_Move_Olfactif")
//				}
//				else
//				{
//					if( i_check_sang_already_done && f_charognard_forced_duration > Cf_charognard_forced_duration_min )
//						BC_Charognard_Mode_Reset()
//				}
//			}
//		}
//	}
//}
//
//if( ! ACT_ActionIsTransition() )
//{
//	// réorientation de la bat sans blend après la transition !!!!
//	OBJ_BankingGeneralSet(
//		MATH_VecBlendRotate(OBJ_SightGet(), v_perchee_init_sight, 1),
//		MATH_VecBlendRotate(OBJ_BankingGet(), v_perchee_init_banking, 1))
//}
//
//