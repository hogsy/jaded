#include "BC_defines.var"

object	to_bat

AI_Execute("BC_cb_tag_off")

EVENT_Delete(mid_interet_attaque, C_EVENT_EOFDEL)		// raz intérêt
EVENT_Delete(mid_interet_charogne, C_EVENT_EOFDEL)		// raz intérêt

// Destruction des objets temporaires =======================================
if( o_tmp_obj_last )
{
	@o_tmp_obj_last OBJ_Destroy()
	o_tmp_obj_last = nobody
}

if( o_tmp_obj_next )
{
	@o_tmp_obj_next OBJ_Destroy()
	o_tmp_obj_next = nobody
}


// Suppr la réserv du wp d'attaque même s'il n'a pas été atteint 
// (donc o_backup_nearest_cible_wp et pas o_backup_wp_depl_utilise )
BC_WP_Reservation_Del(o_backup_nearest_cible_wp)

// CAPA mort ------------------------------------------------------------
OBJ_CapaSet(CAPA_inactive, 0)


// GRAB -------------------------------------------------------------------
if( MSG_GlobalIsValid(mid_grab_charogne) )
	LNK_ClientGet(Ci_LNK_GRAB_RAPTOR, mid_grab_charogne, faux, "BC_exec_grab_param", nofunc, "BC_exec_grab_param")

// GRABBED
o_predateur = LNK_ServeurGet(Ci_LNK_GRAB_RAPTOR, mid_predateur, faux, nofunc, nofunc)

// Javelots -----------------------------------------------------------------
OBJ_LIB_Detach_Javelin(OBJ_Me())

BC_Lieutenant_Del()

// CALLBACKS ==============================
if( ! i_cb_destroy_manual )
{
	// suppr à la vraie destruction
	AI_CBDel(OBJ_Me(), CallBack_After_Blend, "BC_cb_afterblend")
	AI_CBDel(OBJ_Me(), CallBack_WhenDestroy, "BC_cb_when_destroy")
	AI_CBDel(OBJ_Me(), CallBack_Client, "BC_cb_client")
	// Réactivation le wp de chute pour les autres bats =============================
	if( i_chute_reservation_flag )
	{
		i_chute_reservation_flag = faux
		BC_Chute_WP_reservation_free(o_chute_bats_wp)
	}
}
AI_CBDel(OBJ_Me(), CallBack_Info, "BC_cb_info")
macro_del_callback_after_cam("BC_cb_aftercam")

if (!OBJ_FlagsIdentityTest(OBJ_C_IdentityFlag_Generated))
{
	if (i_SF_NePasSeRejouerSiMort)
		Super_SpecialFlag_set(i_SF_AlreadyDead)
}

// STATS (la bat ne meurt pas toujours d'un paf)
BC_STATS_NMI_Killed(o_jack)

// UNCOL =============================
COL_UnCollidableReset()

// Suppr des SoftCol
BC_SoftCol_ForgetMe()

// Snd
if( i_snd_barbeuc != -1 )
{
	SND_Destroy(i_snd_barbeuc)
	i_snd_barbeuc = -1
}

