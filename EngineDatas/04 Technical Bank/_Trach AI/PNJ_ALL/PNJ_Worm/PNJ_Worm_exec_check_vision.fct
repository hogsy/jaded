#include "PNJ_Worm_defines.var"

int					ti_rank
int					ti_ID
int					ti_index

object			to_actor

messageid		tmid_visibility

if (i_flag_visual_check_done)
	return
	
i_flag_visual_check_done = vrai

ti_rank = -1
for (tmid_visibility = MSG_GlobalScan(C_EVENT_TYPE_Visibility, &ti_rank); MSG_GlobalIsValid(tmid_visibility); tmid_visibility = MSG_GlobalScan(C_EVENT_TYPE_Visibility, &ti_rank))
{
	ti_ID = EVENT_VisionIDGet(tmid_visibility)

	if (ti_ID == C_ID_Scorpion)
	{
		PNJ_Worm_Add_Budy(tmid_visibility)
		continue
	}

	if (! IsThis_ID_Humain(ti_ID))
		continue
		
	to_actor = EVENT_PereGet(tmid_visibility)
	
	ti_index = PNJ_Worm_Add_Perceived_Actor(to_actor, 0, tmid_visibility)
	ai_perceived_seen[ti_index] = vrai
}

