#include "KT_defines.var"

int 		ti_i
object	to_pied
vector	tv_pos, tv_temp

if( ! o_Kong )
	return		// SFX gérés dans Kong


for ( ti_i =0; ti_i < 2; ti_i++)
{
	switch(  ti_i)
	{
		case 0 :
			to_pied = ANI_CanalObjectGet( Anim_Canal_OrteilDroit)//ANI_CanalObjectGet( Anim_Canal_PiedDroit)
			break
		case 1 :
			to_pied = ANI_CanalObjectGet( Anim_Canal_OrteilGauche)//ANI_CanalObjectGet( Anim_Canal_PiedGauche)
			break
	}
	if ( ai_walling_SFX[ ti_i] == 0 || ACT_CustomBitGet() & CBit_SFX_ON)
		ai_walling_SFX[ ti_i] = 1				
	DBG_RenderVector( v_IK_ground_pos[ti_i], Cv_VerticalVector, color_vert)
	tv_temp = @to_pied OBJ_PosGet() - v_IK_ground_pos[ti_i]
	if ( MATH_VecNullEpsilon(tv_temp) || MATH_VecDotProduct(OBJ_BankingGet(), MATH_VecNormalize(tv_temp)) < Cf_Cos80 )
	{
		if (ai_walling_SFX[ ti_i] == 1)
		{
			DBG_RenderSphere( v_IK_ground_pos[ti_i], 1.0, 0xFFFF0000)
			v_IK_ground_pos[ti_i] += v_virtual_banking * 0.20
			if ( ACT_CustomBitGet() & CBit_SFX_ON)
				@o_Kong Proc_KK_SFX_Ground(v_IK_ground_pos[ti_i], 1.0)
			else
				@o_Kong Proc_KK_SFX_Ground(v_IK_ground_pos[ti_i], 3.0)
			ai_walling_SFX[ ti_i] = 2		
		}
	}
	else
		ai_walling_SFX[ ti_i] = 0
}

