#include "KNa_Defines.var"

vector tv_pos

// SORTIE ETAT ===================================================================
if (i_flag_sort_etat)
{
	i_flag_sort_etat = faux
	return
}

// INITIALISATION ETAT ==============================================================
if (i_etat_courant != ETAT_Borg)
{
	i_dernier_etat = i_etat_courant
	i_etat_courant = ETAT_Borg

	if (fct_last_etat)
	{
		i_flag_sort_etat = vrai
		AI_Execute(fct_last_etat)
	}
	fct_last_etat = AI_TrackCurGet()
	f_time_start_etat = 0.0
}
else
{
	f_time_start_etat += TIME_GetDt()
}

// PAFs -----------------------------------------------------
AI_Execute("KNa_Exec_CheckPaf")

if (EVT_Paf_Pere)
{
	macro_change_etat("KNa_ETAT_Paf")
}

if (OBJ_CapaTest(Ci_Capa_Go_Follow_Network))
{
	AI_TrackCurChangeNow("KNa_ETAT_Follow_Network")	
}


// SPEECH ==========================================
if( ACT_ActionGet() == Ci_AnimNative_Lance )
{
	switch( ACT_ActionItemGet() )
	{
		case 0 : 	// ready to launch
			i_snd_attack_done = faux
			break
		case 1 :
			if( ! i_snd_attack_done )
			{
				// Na_attack01_05 =====================
//				SPEECH_RequestPost
//				(
//					OBJ_Me(),
//					OBJ_Me(), 
//					0xD00066C9, 
//					0xD00066D0, 
//					1.0, 
//					SPEECH_Cte_PriorityDefault, 
//					5,
//					0,
//					0,
//					0
//				)
				i_snd_attack_done = vrai
			}
			break
	}
}

