int					ti_rank, ti_ID //, ti_attacked
messageid		EVT_ID
message		EVT_msg_filter
float				tf_dist, tf_distbest
object			o_sender

// ()----------( init )----------()
stimul_i_nb = 0
stimul_i_paf = faux
stimul_i_sound = faux
stimul_i_blood = faux
stimul_i_vis = faux

MSG_SetNull( EVT_msg_filter)
EVT_msg_filter.msg_gao1 = OBJ_Me()
ti_rank = -1
EVT_ID = MSG_GlobalSearchIntGao(C_EVENT_TYPE_Paf, &ti_rank, EVT_msg_filter)
while(MSG_GlobalIsValid(EVT_ID))
{
	stimul_i_nb++
	stimul_i_paf = vrai
	stimul_o_pafby = MSG_GlobalGetSender( EVT_ID )
	EVT_ID = MSG_GlobalSearchIntGao(C_EVENT_TYPE_Paf, &ti_rank, EVT_msg_filter)
}

ti_rank = -1
EVT_ID = MSG_GlobalScan(C_EVENT_TYPE_Sound, &ti_rank)
while (MSG_GlobalIsValid(EVT_ID))
{
	tf_dist = EVENT_SoundSizeGet( EVT_ID )
	if (  (tf_dist * tf_dist) > OBJ_SqrDist( MSG_GlobalGetSender(EVT_ID) ) )
	{
		stimul_i_nb++
		stimul_i_sound = vrai
	}
	EVT_ID = MSG_GlobalScan(C_EVENT_TYPE_Sound, &ti_rank)
}

tf_distbest = Cf_Infinit
if (stimul_o_target) 
{
	if ( SCfct_IsInWater( @stimul_o_target OBJ_PosGet() ) )
		tf_distbest = OBJ_SqrDist( stimul_o_target )
}

ti_rank = -1
EVT_ID = MSG_GlobalScan(C_EVENT_TYPE_Visibility, &ti_rank)
while (MSG_GlobalIsValid(EVT_ID))
{
	ti_ID = EVENT_VisionIDGet( EVT_ID )
	if (ti_ID != C_ID_SwampCrawler)
	{
		o_sender = MSG_GlobalGetSender(EVT_ID)
		if (o_sender != OBJ_Me() ) 
		{
			tf_dist = OBJ_SqrDist( o_sender )
			if ( tf_dist < 400 )
			{
				stimul_i_nb++
				stimul_i_vis = vrai
				
//				ti_attacked = 0
//				if (Organizer)
//					ti_attacked = SCfct_IsTargetted( o_sender )
				
				if ( (tf_dist < tf_distbest) && SCfct_IsInWater( @o_sender OBJ_PosGet() ) ) //&& !ti_attacked )
				{
					stimul_o_target = o_sender
					tf_distbest = tf_dist
				}
			}
		}
	}
	EVT_ID = MSG_GlobalScan(C_EVENT_TYPE_Visibility, &ti_rank)
}



