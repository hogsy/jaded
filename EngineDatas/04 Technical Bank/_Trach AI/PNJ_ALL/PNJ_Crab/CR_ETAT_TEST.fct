#include "CR_defines.var"

//vector		tv_sight
//object		tao_children[10]
//int				ti_children_nb
//int				ti_test


// SORTIE ETAT ==============================================================================
if (i_sort_etat)
{
	i_sort_etat = faux
	return
}


// ENTREE ETAT ==============================================================================
if (i_etat_courant != ETAT_TEST )
{
	i_etat_ancien = i_etat_courant
	i_etat_courant = ETAT_TEST
	str_etat = "Test"
	if (fct_etat_courant)
	{
		i_sort_etat = vrai
		AI_Execute(fct_etat_courant)
	}
	
	fct_etat_courant = AI_TrackCurGet()
	fct_etat_main = AI_TrackCurGet()
	f_time_start_etat = 0.0
	
//	ACT_ActionSet(ACTION_SurPlace)
//	ACT_ActionSet(6)
//	ACT_ActionSet(ACTION_Mange)
//	ACT_ActionSet(ACTION_TourneG)

//	ACT_ActionSet(ACTION_Avance_Attaque)
	
	if( i_DBG_trace_etat )
	{
		DBG_TraceObject(OBJ_Me())
		DBG_TraceString(" : ETAT TEST !!!!")
		DBG_TraceEOL()
	}
	
//	o_repli_wp_father = o_blind_zone[0]
//	ti_children_nb = @o_repli_wp_father OBJ_HierarchyGetChilds(&tao_children[0])
//	i_repli_first_wp_index = MATH_RandInt(0, ti_children_nb)
//	i_repli_cur_wp_nb = i_repli_first_wp_index
//	o_repli_wp = nobody
//	i_repli_wp_count = 0
//	CR_Repli_Get_Next_WP(o_repli_wp_father, i_repli_cur_wp_nb, o_repli_wp)

//	ACT_ActionSet(ACTION_Attente)
//	ACT_ActionSet(ACTION_TourneD45marche)
	ACT_ActionSet(ACTION_Intimidation)
}
else
{
	f_time_start_etat += TIME_GetDt()
}


// ANALYSE ===================================================================================

//AI_Execute("CR_exec_CHECK_Vision")
//
//AI_Execute("CR_exec_CHECK_Paf")
//if( CR_Paf_Check_Change_Etat() )
//	macro_change_etat("CR_ETAT_PAF")

// COMPORTEMENT =============================================================================

//if( o_DBG_force_attack_gao )
//	tv_sight = MATH_VecBlendRotate(OBJ_SightGet(), @o_DBG_force_attack_gao OBJ_PosGet() - OBJ_PosGet(), 0.25 * TIME_GetDt())
//else
//	tv_sight = OBJ_SightGet()

//tv_sight = MATH_VecBlendRotate(OBJ_SightGet(), OBJ_HorizonGet(), 0.25 * TIME_GetDt())

//OBJ_BankingGeneralSet(tv_sight, macro_banking)

//switch( ACT_ActionGet() )
//{
//	case ACTION_Avance_Attaque :
//		if( f_time_start_etat > 1.0 )
//		{
//			ACT_ActionSet(ACTION_TourneG45debut)
//		}
//		break
//	case ACTION_TourneG45debut :
//		if( ACT_ActionFinished() )
//		{
//			ACT_ActionSet(ACTION_TourneG45marche)
//			f_time_start_etat = 0.0
//		}
//		break
//	case ACTION_TourneG45marche : 
//		if( f_time_start_etat > 1.5 )
//		{
//			ACT_ActionSet(ACTION_TourneG45fin)
//		}
//		break
//	case ACTION_TourneG45fin : 
////		OBJ_BankingGeneralSet(@o_main_actor OBJ_PosGet() - OBJ_PosGet(), Cv_VerticalVector)
////		OBJ_BankingGeneralSet(MATH_VecBlendRotate(OBJ_SightGet(), @o_main_actor OBJ_PosGet() - OBJ_PosGet(), 10 * TIME_GetDt()), Cv_VerticalVector)
//		if( ACT_ActionFinished() )
//		{
//			ACT_ActionSet(ACTION_Avance_Attaque)
//			f_time_start_etat = 0.0
//		}
//		break
//}


//CR_Repli_Get_Next_WP(o_repli_wp_father, i_repli_cur_wp_nb, o_repli_wp)


//ti_test = CR_ConeDeVision_Check(o_main_actor)
//ti_test = ti_test

return

if( ACT_ActionGet() == ACTION_Attente && f_time_start_etat > 1.0 )
{
	ACT_ActionSet(ACTION_Paf_Mortel_Variante)
}
else if( ACT_ActionFinished() )
{
	if( ACT_ActionGet() == 25 || ACT_ActionGet() == 26 )
	{
		ACT_ActionSet(27)
		DYN_Off()
	}
	else if( ACT_ActionGet() == 29 )
	{
//		ACT_ActionSet(30)
		ACT_ActionSet(31)
		DYN_Off()
	}
	else if( ACT_ActionGet() == ACTION_Paf_Mortel_Variante )
	{
		ACT_ActionSet(ACTION_Mort_Variante)
		DYN_Off()
	}
	else if( ACT_ActionGet() == 34 )
	{
		ACT_ActionSet(35)
		DYN_Off()
	}
}


