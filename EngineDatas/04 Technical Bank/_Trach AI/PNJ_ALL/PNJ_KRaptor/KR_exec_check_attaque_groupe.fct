

//==================================================================================
// TEST DES INTERETS DES AUTRES RAPTORS POUR FAVORISER LES ATTAQUES GROUPEES
//==================================================================================

#include "KR_defines.var"

int					ti_rank
messageid		tmid_interet_ID
message		tm_filter
messageid		tmid_vision_ID
int					ti_sender_ID
object			to_pere

float				tf_interet
messageid		tm_grab_ID
int					ti_visibility_filter
int					ti_ann_kkgrab

o_proie_groupe = nobody
f_time_check_proie_groupe = TIME_Get()

// TEST ATTAQUES SUR ANN ============================================================

if( ! o_ANN )
	return

MSG_SetNull(tm_filter)
tm_filter.msg_gao1 = o_ANN

ti_rank = -1
for (	tmid_interet_ID = MSG_GlobalSearchIntGao(C_EVENT_TYPE_Interet, &ti_rank, tm_filter);
		MSG_GlobalIsValid(tmid_interet_ID);
		tmid_interet_ID = MSG_GlobalSearchIntGao(C_EVENT_TYPE_Interet, &ti_rank, tm_filter) )
{
	to_pere = EVENT_PereGet(tmid_interet_ID)
	
	if( to_pere != OBJ_Me() )
	{
		tmid_vision_ID = EVENT_FindEventPereTarget( C_EVENT_TYPE_Visibility, to_pere, nobody)
		if( MSG_GlobalIsValid(tmid_vision_ID) )
		{
			ti_sender_ID = EVENT_VisionIDGet(tmid_vision_ID)
			if( ti_sender_ID == C_ID_Raptor )
			{
				o_proie_groupe = o_ANN
				tmid_vision_ID = EVENT_FindEventPereTarget( C_EVENT_TYPE_Visibility, o_ANN, nobody)
				if( MSG_GlobalIsValid(tmid_vision_ID) )
					tf_interet = EVENT_VisionInteretGet(tmid_vision_ID)
				else
					tf_interet = 555
				break
			}
		}
	}
}

