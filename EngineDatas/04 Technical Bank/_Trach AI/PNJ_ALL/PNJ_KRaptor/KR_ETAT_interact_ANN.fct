//#include "KR_defines.var"
//
//int			ti_i
//int			ti_action
//int			ti_etat_phase
//int			ti_trame
//int			ti_interaction_param
//int			ti_deplacement
//
//object	to_head
//object	to_grab_actor
//
//vector	tv_temp
//vector	tv_normal 
//vector	tv_new_sight
//
//float		tf_dist
//
//
//// SORTIE ETAT ===================================================================
//if (i_sort_etat)
//{
//	KR_DBG_Trace(i_DBG_trace_interaction, "sortie du mode interact_ANN\n\n")
//	i_sort_etat = faux
//	if( o_ANN )
//		o_interaction_target = LNK_ThisClientGet(o_ANN, Ci_LNK_INTERACTION, mid_interaction, faux, nofunc, nofunc, nofunc)	
//	return
//}
//
//// INITIALISATION ETAT ==============================================================
//if (i_etat_courant != ETAT_interact_ANN)
//{
//	i_dernier_etat = i_etat_courant
//	i_etat_courant = ETAT_interact_ANN
//	if (fct_last_etat)
//	{
//		i_sort_etat = vrai
//		AI_Execute(fct_last_etat)
//	}
//	fct_last_etat = AI_TrackCurGet()
//	f_time_start_etat = 0.0
//	f_interaction_timer = 0.0
//	
////	if( i_DBG_trace_interaction )
////		DBG_TraceEOL()
//	KR_DBG_Trace(i_DBG_trace_interaction, "entrée dans le mode interact_ANN =============")
//	
//	ACT_ActionSet(Action_Normal_Attente)
//	
//	KR_SetInterestType(C_EVENT_InteretStatusAttack)
//}
//else
//{
//	f_time_start_etat += TIME_GetDt()
//}
//
//// ANALYSE =======================================================================================================
//
//if( ! o_ANN )
//	macro_change_etat("KR_ETAT_attente")
//
//i_iam_a_kong_target = vrai
//i_iam_a_kam_target = vrai
//i_flag_zde_fight_enable = vrai
//
//o_grabbed_actor_KK = LNK_ServeurGet(Ci_LNK_GRAB_KONG, mid_grabbed_by_Kong_LNK_ID, vrai, nofunc, nofunc)
//if (o_grabbed_actor_KK)
//{
//	KR_DBG_Trace(i_DBG_trace_interaction, "je me suis fais grabber -> ETAT grabbed")
//	macro_change_etat("KR_ETAT_grabbed")
//}
//
//if( ! KR_Check_Fight_Actor_Interet() )
//{
//	KR_DBG_Trace(i_DBG_trace_interaction, "KR_Check_Fight_Actor_Interet() == faux -> ETAT Attente")
//	macro_change_etat("KR_ETAT_attente")
//}
//
//AI_Execute("KR_exec_check_paf")
//if( o_paf_actor )
//{
//	KR_Select_Paf_Etat(fct_track_change)
//	if( fct_track_change != nofunc )
//	{
//		KR_DBG_Trace(i_DBG_trace_interaction, "o_paf_actor -> ETAT paf")
//		macro_change_etat(fct_track_change)
//	}
//}
//
//o_interaction_target = LNK_ThisClientGet(o_ANN, Ci_LNK_INTERACTION, mid_interaction, vrai, "KR_CALLBACK_interaction_add_data", nofunc, "KR_CALLBACK_interaction_init")
//if( ! o_interaction_target )
//{
//	KR_DBG_Trace(i_DBG_trace_interaction, "interaction coupée -> ETAT fight ANN")
//	macro_change_etat("KR_ETAT_fight_ANN")
//}
//
////if( ACT_ActionGet() == Action_Paf_Sol_D || ACT_ActionGet() == Action_Paf_Sol_G )
////{
////	if( ACT_ActionFinished() )
////		ACT_ActionSet(Action_Tombe_SeReleve)
////}
////else if( ACT_ActionGet() == Action_Tombe_SeReleve )
////{
////	if( ACT_ActionFinished() )
////	{
////		f_way_rot_speed = 0.0
////		ACT_ActionSet(Action_Normal_Marche)
////	}
////}
//if( ACT_ActionGet() == Ci_Action_Paf_PetitSol )
//{
////	if( ACT_ActionFinished() )
//	if( ANI_CurrentFrameGet(0) > 30 )
//	{
//		f_way_rot_speed = 0.0
//		ACT_ActionSet(Action_Normal_Marche)
//	}
//}
//else
//{
//	ti_interaction_param = LNK_InteractionParamGet(mid_interaction)
//	switch( ti_interaction_param )
//	{
//		case C_INTER_FIGHT_WAIT_FOR_ANN :
//			if( ACT_ActionGet() != Action_Normal_Attente )
//			{
//				f_way_rot_speed = 0.0
//				ACT_ActionSet(Action_Normal_Attente)
//			}
//			break
//			
//		case C_INTER_FIGHT_ANN_READY :
//			tf_dist = OBJ_SqrDist(o_ANN)
//			if( tf_dist > 16.0 )
//				ACT_ActionSet(Action_Normal_Marche)
//			else
//			{
//				f_interaction_timer = 0.0
//				i_flag_bite_ok = faux
//				SND_RequestPlay(Ci_SND_Roar)
//				if( @o_ANN KAnn_Death_Attack_Enabled() )
//				{
//					ACT_ActionSet(Action_Fight_MordRapide)
//					LNK_InteractionParamSet(mid_interaction, C_INTER_FIGHT_ENNEMY_ATTACK )
//				}
//				else
//				{
//					ACT_ActionSet(Action_Fight_Mord)
//					LNK_InteractionParamSet(mid_interaction, C_INTER_FIGHT_ENEMY_FAKE_ATTACK )
//					@get_global i_KAnn_fake_attack_index = MATH_Modulo(@get_global i_KAnn_fake_attack_index +1, 2)
//				}
//			}
//			break
//			
//		case C_INTER_FIGHT_ENEMY_FAKE_ATTACK :
//			if( ACT_ActionGet() == Action_Fight_Mord && ACT_ActionFinished() )
//				ACT_ActionSet(Action_Normal_Attente)
//			break
//			
//		case C_INTER_FIGHT_ENNEMY_ATTACK :
//			switch( ACT_ActionGet() )
//			{
//				case Action_Fight_MordRapide :
//					if( ACT_ActionFinished() )
//						ACT_ActionSet(Action_Devore)
//					else
//					{
//						ti_trame = ANI_CurrentFrameGet(0)
//						if( ( ! i_flag_bite_ok ) && (ti_trame >= 6 && ti_trame <= 14) )		// paf possible pendant cette durée
//							i_flag_bite = vrai
//					}
//					break
//					
//				default:
//					break
//			}
//			break
//		
//		case C_INTER_FIGHT_ANN_FAKING_ATTACK :
////			if( ACT_ActionGet() != Action_Paf_Sol_D && ACT_ActionGet() != Action_Paf_Sol_G )
//			if( ACT_ActionGet() != Ci_Action_Paf_PetitSol )
//			{
//				f_interaction_timer += TIME_GetDt()
//				if( f_interaction_timer > f_interaction_timer_max )
//				{		
////					if( @get_global i_KAnn_fake_attack_index == 0 )
////						ACT_ActionSet(Action_Paf_Sol_D)
////					else
////						ACT_ActionSet(Action_Paf_Sol_G)
//					ACT_ActionSet(Ci_Action_Paf_PetitSol)
//					tv_temp = MATH_RandFloat(8.0, 15.0) * OBJ_HorizonGet()
//					tv_temp *= MATH_FloatSign(MATH_RandFloat(-1.0,1.0))
//					tv_temp -= (10 * OBJ_SightGet())
//					DYN_SpeedSetVector(tv_temp)		// Vitesse initiale du paf
//					f_interaction_timer = 0.0
//				}
//			}
//			else if( ACT_ActionFinished() )
//			{
//				f_way_rot_speed = 0.0
//				ACT_ActionSet(Action_Normal_Attente)
//			}
//			break
//			
//		default:
//			if( ACT_ActionFinished() )
//				ACT_ActionSet(Action_Normal_Attente)
//			break		// c'est Ann qui gère, moi je termine mon action
//	}
//	
//	
//	// CHOOSE ATTACK TARGET -----------------------------------
//	AI_Execute("KR_exec_select_fight_actor")
//	if (o_fight_actor != o_ANN)
//	{
//		if (o_fight_actor == o_KONG)
//		{
//			KR_DBG_Trace(i_DBG_trace_interaction, "KR_exec_select_fight_actor / o_fight_actor == o_KONG -> ETAT fight KONG")
//			macro_change_etat("KR_ETAT_fight_KONG")
//		}
//		else
//		{
//			KR_DBG_Trace(i_DBG_trace_interaction, "KR_exec_select_fight_actor / o_fight_actor != o_ANN & != o_KONG => ETAT Attente")
//			macro_change_etat("KR_ETAT_attente")
//		}
//	}
//}
//
//
//// ORIENTATION ---------------------------------------
//v_sens_orientation = @o_ANN OBJ_PosGet() - OBJ_PosGet()
//switch( ACT_ActionGet() )
//{
////	case Action_Paf_Sol_D :
////		v_sens_orientation = MATH_VecRotate(v_sens_orientation, KR_WorldBankingGet(), Cf_PiBy2)
////		break
////	case Action_Paf_Sol_G :
////		v_sens_orientation = MATH_VecRotate(v_sens_orientation, KR_WorldBankingGet(), - Cf_PiBy2)
////		break
////	case Action_Tombe_SeReleve :
//	case Ci_Action_Paf_PetitSol :
//		v_sens_orientation = OBJ_SightGet()
//		break
//	default:
//		break
//}
//
//if( ACT_ActionGet() == Ci_Action_Paf_PetitSol )
//{
//	f_way_rot_speed = 0.0
//	OBJ_BankingGeneralSet(OBJ_SightGet(), MATH_VecBlendRotate(OBJ_BankingGet(), KR_WorldBankingGet(), 6.0 * TIME_GetDt()))
//}
//else
//{
//	f_way_rot_speed = MATH_FloatBlend(f_way_rot_speed, 6.0, 2.0 * TIME_GetDt())
//	OBJ_BankingGeneralSet(
//		MATH_VecBlendRotate(OBJ_SightGet(), v_sens_orientation, f_way_rot_speed * TIME_GetDt()),
//		MATH_VecBlendRotate(OBJ_BankingGet(), KR_WorldBankingGet(), 6.0 * TIME_GetDt()))
//}
//
//
//
//