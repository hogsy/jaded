
#include"KNG_Defines.var"

int					ti_rank
int					ti_paf_type 
float				ti_puissance
int					ti_canal
float				tf_paf_value, tf_paf
vector			tv_paf_dir
messageid		tmid_paf_event
message		EVT_msg_filter
int					ti_i

if (i_no_paf)
	return

EVT_Paf_Pere = nobody

MSG_SetNull( EVT_msg_filter)
EVT_msg_filter.msg_gao1 = OBJ_Me()			// Je cherche tous les Events Paf me concernant !

ti_rank = -1
tf_paf_value = 0
tv_paf_dir = Cv_NullVector
ti_canal = -1

tmid_paf_event = MSG_GlobalSearchIntGao(C_EVENT_TYPE_Paf, &ti_rank, EVT_msg_filter)
while(MSG_GlobalIsValid(tmid_paf_event))
{
	ti_paf_type = EVENT_PafTypeGet(tmid_paf_event)
	ti_puissance = EVENT_PafPuisGet(tmid_paf_event)
	EVT_Paf_Pere = EVENT_PereGet(tmid_paf_event)

//	tmid_vision_event = EVENT_FindEventPereTarget(C_EVENT_TYPE_Visibility, EVT_Pere, nobody)
//	if (!MSG_GlobalIsValid(tmid_vision_event))
//		DBG_Error("Je suis pafé par quelqu'un qui n'existe pas !!!")

	v_paf_dir = EVENT_PafDirGet(tmid_paf_event)

	// POINTS DE VIE
	//f_lifecur -= MATH_FloatMin(f_lifecur, tf_puissance)
	//f_paf_degats += tf_puissance

	v_paf_dir = MATH_VecNormalize(v_paf_dir)
	
	for (ti_i = 0; ti_i < i_number_of_natives; ti_i++)
	{
		EVENT_AddEventPafCanal( C_EVENT_FILTER_Object, C_PAF_KK_Moyen + C_PAF_KK_KiTue, EVT_Paf_Pere, Cf_EVENT_Duree_1Trame, ao_native_list[ti_i], -1, ti_puissance , v_paf_dir, COL_ZonePosGet( C_zde_fight))
	}

	tmid_paf_event = MSG_GlobalSearchIntGao(C_EVENT_TYPE_Paf, &ti_rank, EVT_msg_filter)
}

