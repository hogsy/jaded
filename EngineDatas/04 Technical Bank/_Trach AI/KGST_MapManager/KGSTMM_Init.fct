#include "KGSTMM_defines.var"

object to_KONG
//object to_ANN
#ifndef _FINAL_
object		to_worldObject
object		to_enemy
int				ti_nb_objects				// Nb d'elements dans le tableau de WP
int				ti_enemy_visibility
object		to_spawnerSource
int				ti_i
int				ti_current_system
int				ti_interesting
#endif

to_KONG = @"univ" ao_AllHumains[ C_ID_Kong ]
//to_ANN =  @"univ" ao_AllHumains[ C_ID_Ann ]

if (to_KONG)
{
	switch (i_ann_at_start)
	{
		case Ci_ANN_START_ON_GROUND :
			@get_Kong_Path to_KONG i_je_dois_chopper_ann_a_init = faux
			break
		
		case Ci_ANN_START_ON_KONG :
			@get_Kong_Path to_KONG i_je_dois_chopper_ann_a_init = vrai
			break	
			
		case Ci_ANN_START_ON_SACRIFICE :
			@get_Kong_Path to_KONG i_je_dois_chopper_ann_a_init = faux
//			@to_ANN OBJ_CapaSet(OBJ_Capa_2, none)
			break	
	}
}

#ifndef _FINAL_
if (i_enemy_activity > 0)
{
	if (i_enemy_activity == 1)
		ti_enemy_visibility = 0
	else
		ti_enemy_visibility = 1

	ti_nb_objects = WOR_GetNumObject(0)
	for (ti_i = 0; ti_i < ti_nb_objects; ti_i++)
	{
		to_worldObject = WOR_GetObject(0,ti_i)

		if (!to_worldObject)
			continue
			
		if (@to_worldObject AI_IsModel("Generator/Spawner"))
			to_enemy = @"Generator/Spawner" to_worldObject mo_Enemy
		else
			to_enemy = to_worldObject

		if (!to_enemy)
			continue
		
		// came up with the following (instead of a big if (a||b||c||d) to get rid of a <global stack is full> problem
		ti_interesting = faux
		if 	(@to_enemy AI_IsModel(get_PNJ_KTREX_Path))						// T-REX
		{
			ti_interesting = vrai
			@get_PNJ_KTREX_Path to_enemy i_actif = faux		// pffff
		}
		else if (@to_enemy AI_IsModel(get_PNJ_KNative_path))
			ti_interesting = vrai
		else if (@to_enemy AI_IsModel(get_PNJ_KBats_path))
			ti_interesting = vrai
		else if (@to_enemy AI_IsModel(get_PNJ_KRaptor_path))
			ti_interesting = vrai
		else if (@to_enemy AI_IsModel("Kanada2/KNativeGroup"))
			ti_interesting = vrai
		else if (@to_enemy AI_IsModel("Kanada/KPluieDeLances"))
			ti_interesting = vrai
		if (!ti_interesting)
			continue

		// set inactive instanciated enemies
		@to_worldObject OBJ_FlagInactiveSet(vrai)
		if (!ti_enemy_visibility)
			@to_enemy OBJ_FlagInvisibleSet(vrai)
	}
}
#endif





AI_TrackChange(0, "KGSTMM_Run")
