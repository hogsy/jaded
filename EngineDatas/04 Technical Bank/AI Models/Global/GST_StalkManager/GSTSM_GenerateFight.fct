#include "GST_StalkManager_defines.var"

int				wp, enemy
object		o_wp, o_New
message	msg

wp = pop
o_wp =  mao_Fight_WP[ wp ]
maf_Fight_Timer[ wp ] = mf_FightTimer

for (enemy = 0; enemy < STALK_MaxFightEnemy ; enemy++)
{
	if ( mao_FightEnemy[ enemy ] == nobody)
		break
}
if (enemy == STALK_MaxFightEnemy )
	return

o_New = @mo_Enemy OBJ_Duplicate( @o_wp OBJ_PosGet() )
@o_New OBJ_FlagInvisibleSet( 1 )

mao_FightEnemy[ enemy ] = o_New
OBJ_RegisterKill( mao_FightEnemy[ enemy  ], &mao_FightEnemy[ enemy  ] )

msg.msg_sender = OBJ_Me()
msg.msg_gao1 = o_wp
msg.msg_gao2 = mo_Fight_Target
msg.msg_id = msg_id_stalkattack

@o_New MSG_Send( msg )


