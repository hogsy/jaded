#include "GS_Constant.var"




//-------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------
procedure_local void SND_TraceGrpVol(int argi_grpid, string args_msg, float argf_vol)
{
#ifndef _FINAL_	
	if(i_DebugMode == 1)
	{
		if(i_Dbg_TraceGroupId == argi_grpid)
		{
			DBG_TraceString("[GST_SOUND] ")
			DBG_TraceString(args_msg)
			DBG_TraceString(" ")
			DBG_TraceFloat(argf_vol)
			DBG_TraceEOL()
		}
	}
#endif	
}


//-------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------
procedure_local void SND_GotoModeDying()
{
	int ti
	
	for(ti=SND_Cte_GrpSpecialFX; ti<SND_Cte_MasterGrp; ti++)
	{
		if (ti == SND_Cte_GrpMusic) continue
		SND_M_FadeGroup(ti, 0.0, 0.5)
	}		
	
	// Fx A
	SND_FxSeti(SND_Cte_Fx_iCoreId, SND_Cte_FxCoreA)
	SND_FxSeti(SND_Cte_Fx_iContext, SND_Cte_FxContextGlobal)
	SND_FxSeti(SND_Cte_Fx_iMode, GS_Cte_FxLoading_Mode)
	SND_FxSeti(SND_Cte_Fx_iDelay, GS_Cte_FxLoading_Delay)
	SND_FxSeti(SND_Cte_Fx_iFeedback, GS_Cte_FxLoading_Feedback)
	SND_FxSetf(SND_Cte_Fx_fWetVol, GS_Cte_FxLoading_WetVol)
	SND_FxSeti(SND_Cte_Fx_iWetPan, GS_Cte_FxLoading_WetPan)
	SND_FxSeti(SND_Cte_Fx_iEnable, 1)
	
	// Fx B
	SND_FxSeti(SND_Cte_Fx_iCoreId, SND_Cte_FxCoreB)
	SND_FxSeti(SND_Cte_Fx_iContext, SND_Cte_FxContextGlobal)
	SND_FxSeti(SND_Cte_Fx_iMode, GS_Cte_FxLoading_Mode)
	SND_FxSeti(SND_Cte_Fx_iDelay, GS_Cte_FxLoading_Delay)
	SND_FxSeti(SND_Cte_Fx_iFeedback, GS_Cte_FxLoading_Feedback)
	SND_FxSetf(SND_Cte_Fx_fWetVol, GS_Cte_FxLoading_WetVol)
	SND_FxSeti(SND_Cte_Fx_iWetPan, GS_Cte_FxLoading_WetPan)
	SND_FxSeti(SND_Cte_Fx_iEnable, 1)
}


//-------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------
procedure_local void SND_GotoModeSurvival()
{
	int ti
	
	for(ti=SND_Cte_GrpSpecialFX; ti<SND_Cte_MasterGrp; ti++)
	{
		if (ti == SND_Cte_GrpMusic) continue
		SND_M_FadeGroup(ti, 1.0, 0.5)
	}		 
}


//-------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------
procedure_local void SND_GotoModeEnterMenu()
{
	int ti
	
	for(ti=SND_Cte_GrpSpecialFX; ti<SND_Cte_MasterGrp; ti++)
	{
		SND_M_FadeGroup(ti, GC_Cte_MenuVolume, 1.0)
	}
	SND_M_FadeGroup(SND_Cte_GrpA, GC_Cte_MenuVolume, 0.5)
	SND_M_FadeGroup(SND_Cte_GrpB, GC_Cte_MenuVolume, 0.5)
	
	SND_M_FadeGroup(SND_Cte_GrpInterface, 1.0, 0.5)
	SND_Seti(SND_Cte_SetFreeze3DVol, 1)
	SND_Seti(SND_Cte_SetFreezeDynamicPan, 1)

	SND_TrackSeti(-1, SND_Cte_TrackRq_PauseAll, 1)
}


//-------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------
procedure_local void SND_GotoModeExitMenu()
{
	int ti
	
	for(ti=SND_Cte_GrpSpecialFX; ti<SND_Cte_MasterGrp; ti++)
	{
		SND_M_FadeGroup(ti, 1.0, 0.5)
	}
	SND_M_FadeGroup(SND_Cte_GrpA, 1.0, 0.5)
	SND_M_FadeGroup(SND_Cte_GrpB, 1.0, 0.5)

	SND_M_FadeGroup(SND_Cte_GrpInterface, 0.0, 0.5)
	SND_Seti(SND_Cte_SetFreeze3DVol, 0)
	SND_Seti(SND_Cte_SetFreezeDynamicPan, 0)
	
	SND_TrackSeti(-1, SND_Cte_TrackRq_UnpauseAll, 1)
}


//-------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------
procedure_local void SND_GotoModeLoading()
{
	SND_Seti(SND_Cte_SetLoading, 1)
		
	// Fx A
	SND_FxSeti(SND_Cte_Fx_iCoreId, SND_Cte_FxCoreA)
	SND_FxSeti(SND_Cte_Fx_iContext, SND_Cte_FxContextGlobal)
	SND_FxSeti(SND_Cte_Fx_iEnable, 3) // unlock
	SND_FxSeti(SND_Cte_Fx_iMode, GS_Cte_FxLoading_Mode)
	SND_FxSeti(SND_Cte_Fx_iDelay, GS_Cte_FxLoading_Delay)
	SND_FxSeti(SND_Cte_Fx_iFeedback, GS_Cte_FxLoading_Feedback)
	SND_FxSetf(SND_Cte_Fx_fWetVol, GS_Cte_FxLoading_WetVol)
	SND_FxSeti(SND_Cte_Fx_iWetPan, GS_Cte_FxLoading_WetPan)
	SND_FxSeti(SND_Cte_Fx_iEnable, 1) // validate
	
	// Fx B
	SND_FxSeti(SND_Cte_Fx_iCoreId, SND_Cte_FxCoreB)
	SND_FxSeti(SND_Cte_Fx_iContext, SND_Cte_FxContextGlobal)
	SND_FxSeti(SND_Cte_Fx_iEnable, 3) // unlock
	SND_FxSeti(SND_Cte_Fx_iMode, GS_Cte_FxLoading_Mode)
	SND_FxSeti(SND_Cte_Fx_iDelay, GS_Cte_FxLoading_Delay)
	SND_FxSeti(SND_Cte_Fx_iFeedback, GS_Cte_FxLoading_Feedback)
	SND_FxSetf(SND_Cte_Fx_fWetVol, GS_Cte_FxLoading_WetVol)
	SND_FxSeti(SND_Cte_Fx_iWetPan, GS_Cte_FxLoading_WetPan)
	SND_FxSeti(SND_Cte_Fx_iEnable, 1) // validate
}

//-------------------------------------------------------------------------------------------------------------------
//-------------------------------------------------------------------------------------------------------------------
procedure_local void SND_GotoModeEndLoading()
{
	SND_Seti(SND_Cte_SetLoading, 0) 
}


