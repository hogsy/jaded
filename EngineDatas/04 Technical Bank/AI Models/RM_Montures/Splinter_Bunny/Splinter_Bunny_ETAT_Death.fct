#include "Splinter_Bunny_defines.var"

Include_UltraProcedure_Header

int		ti_i

if (i_flag_sortie_etat)
{
	i_flag_sortie_etat = faux
	return
}

if (i_etat_courant != ETAT_Death)
{
	// INTIALISATION
	i_dernier_etat = i_etat_courant
	i_etat_courant = ETAT_Death
	
	if (fct_last_etat)
	{
		i_flag_sortie_etat = vrai
		AI_Execute(fct_last_etat)
	}
	
	fct_last_etat = AI_TrackCurGet()
	
	i_flag_on_ground = vrai

	ai_modules_locked[0] = faux
	ai_modules_locked[i_rided_module_index] = faux

	i_rided_module_index = -1

	o_Rided_Actor = LNK_ServeurGet(Ci_LNK_RIDE_ON_NMI, mid_Rided_LNK_ID, faux, nofunc, nofunc)

	f_time_start_etat = 0.0
}
else
{
	f_time_start_etat += TIME_GetDt()
}

// ANALYSE ===============================================================
if (f_time_start_etat > 3.0)
{
	for (ti_i = 0; ti_i < Ci_line_nb; ti_i++)
	{
		GFX_Del(ai_modules_line[ti_i])
		ai_modules_line[ti_i] = -1
	}
	
	OBJ_Destroy()
}

// COMPORTEMENT =========================================================
f_dt = TIME_GetDt()
Splinter_Bunny_Rag_Doll()
Splinter_Bunny_Display()
