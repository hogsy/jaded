#define Capa_switch OBJ_Capa_7

if (OBJ_CapaTest(Capa_switch) )
	current_step++

OBJ_CapaSet(0,Capa_switch)
if (AI_TriggerIsValid(Test_reinit)&&call_trigger(Test_reinit))
{
	current_step=4
}
//Str_DisplayIntOnce(current_step, cvector(0.5,0.5,0))

switch ( current_step ) 
{
	case 0 :
		break

	case 1 :
		f_morph_progression = MATH_FloatBlend (f_morph_progression, des_step_01, des_f_delai_morph_step_01 * TIME_GetDt())
		break

	case 2 :
		f_morph_progression = MATH_FloatBlend (f_morph_progression, des_step_02, des_f_delai_morph_step_02 * TIME_GetDt())
 		break

 	case 3 :
		f_morph_progression = MATH_FloatBlend (f_morph_progression, des_step_03, des_f_delai_morph_step_03 * TIME_GetDt())
 		break
	
	case 4 :
		f_morph_progression = MATH_FloatBlend (f_morph_progression, 0 , 3 * TIME_GetDt())
		//current_step=0 
		break	

	default:
	current_step=1
		return
}



//des_steptf_morph_offset = des_f_morph_final_prog - des_f_morph_init_prog
//
//if (des_activation==1)
//	f_morph_progression += (tf_morph_offset / des_f_delai_morph_in) * TIME_GetDt()
//else if (OBJ_CapaTest(Capa_switch))
//{
//	f_morph_progression += (tf_morph_offset / des_f_delai_morph_in) * TIME_GetDt()
//}
//else
//{
//	if (des_colmap_init)
//		@des_colmap_init COL_ColMapActivationSet(all, none)
//
//	if (des_colmap_final)
//		@des_colmap_final COL_ColMapActivationSet(none, all)
//
//	f_morph_progression -= (tf_morph_offset / des_f_delai_morph_out) * TIME_GetDt()
//}
//
//if (des_mode == 1)
//{
//	if (f_morph_progression > des_f_morph_final_prog)
//		f_morph_progression = des_f_morph_init_prog + (f_morph_progression - des_f_morph_final_prog)
//}
//else
//{
//	if (f_morph_progression > des_f_morph_final_prog)
//	{
//		f_morph_progression = des_f_morph_final_prog
//
//		// Cas particulier, plus besoin de jouer l'IA
//		OBJ_MorphProgSet(0, f_morph_progression)
//		OBJ_MorphFactorSet(0, 1)
//
//		if (des_colmap_init)
//			@des_colmap_init COL_ColMapActivationSet(none, all)
//
//		if (des_colmap_final)
//			@des_colmap_final COL_ColMapActivationSet(all, none)
//
//		if (des_activation)
//		{
//			if	(des_mode == -1)
//			{	OBJ_Destroy()	}
//			AI_TrackCurStop()
//		}
//	}
//	else if (f_morph_progression < des_f_morph_init_prog)
//	{
//		f_morph_progression = des_f_morph_init_prog
//
//		// Cas particulier, plus besoin de jouer l'IA
//		OBJ_MorphProgSet(0, f_morph_progression)
//
//		if (des_activation)
//		{
//			if	(des_mode == -1)
//			{	OBJ_Destroy()	}
//			AI_TrackCurStop()
//		}
//	}
//}
//

OBJ_MorphProgSet(0, f_morph_progression)
OBJ_MorphFactorSet(0, 1)

