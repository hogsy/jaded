#include "SFX_Banc_poissons_VAR.var"

int			ti_cpt1
vector	tv_pos
float 		tf_tmp_scale
vector 	tv_BV_min, tv_BV_max

tv_BV_min = @o_BV_ref BV_MinGet() + (@o_BV_ref OBJ_PosGet() - OBJ_PosGet())
tv_BV_max = @o_BV_ref BV_MaxGet() + (@o_BV_ref OBJ_PosGet() - OBJ_PosGet())

if (i_nb_creatures>NB_CREATURES)
	i_nb_creatures = NB_CREATURES

f_distance *= f_distance
f_attenuation = f_attenuation / 10


//---------------------------------------------------------------------------------------------------------------------
//		GENERATION DES WAYPOINTS INITIAUX
//---------------------------------------------------------------------------------------------------------------------
for (ti_cpt1=0; ti_cpt1<i_nb_creatures ; ti_cpt1++)
{
	v_list_obj[ti_cpt1] = PROC_GEN_WP(@o_BV_ref BV_MinGet(), @o_BV_ref BV_MaxGet())
	tv_pos = OBJ_PosGet()

	tf_tmp_scale = (f_taille + MATH_RandFloat(-f_random_taille, f_random_taille))

	if (o_ref)
		if (ti_cpt1 == (i_nb_creatures -1))
			o_list_obj[ti_cpt1] = o_ref
		else
			o_list_obj[ti_cpt1] = @o_ref OBJ_Duplicate(tv_pos)

	@o_list_obj[ti_cpt1] OBJ_ScaleSet(cvector(tf_tmp_scale, tf_tmp_scale, tf_tmp_scale))

	v_list_dir_obj[ti_cpt1] = Cv_NullVector
	i_list_jump[ti_cpt1] = faux
}

//---------------------------------------------------------------------------------------------------------------------
//		GENERATION DES WAYPOINTS DE DESTINATION
//---------------------------------------------------------------------------------------------------------------------
for (ti_cpt1=0; ti_cpt1<i_nb_creatures ; ti_cpt1++)
//	v_list_dest_obj[ti_cpt1] = PROC_GEN_WP(@o_BV_ref BV_MinGet() + @o_BV_ref OBJ_PosGet() - v_init_ref_pos, @o_BV_ref BV_MaxGet() + @o_BV_ref OBJ_PosGet() - v_init_ref_pos)
	v_list_dest_obj[ti_cpt1] = PROC_GEN_WP(tv_BV_min , tv_BV_max)

AI_TrackCurChangeNow("SFX_Banc_poissons_LOOP")
