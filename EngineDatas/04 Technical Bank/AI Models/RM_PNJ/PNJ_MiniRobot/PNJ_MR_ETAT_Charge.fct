#include "PNJ_mr_defines.var"

vector	tv_pos, tv_sens
object	to_target

// SORTIE ETAT ===================================================================
if( i_sort_etat )
{
	i_sort_etat = faux
	f_Charge = -1.0
	SND_Stop(i_SND_MR_ChargeOeil)
	i_SND_MR_ChargeOeil=-1	
	return
}

// INITIALISATION ETAT ==============================================================
if( i_etat_courant != ETAT_PNJ_MR_Charge)
{
	i_dernier_etat = i_etat_courant
	i_etat_courant = ETAT_PNJ_MR_Charge
	if( fct_last_etat )
	{
		i_sort_etat = vrai
		AI_Execute(fct_last_etat)
	}
	fct_last_etat = AI_TrackCurGet()
	f_Charge = 0.0
	f_time_start_etat = 0.0
	i_SND_MR_ChargeOeil = SND_RequestPlayLoop(Ci_SND_MR_ChargeOeil)
	OBJ_CapaSet(Obj_Capa_Fight,none)
}
else
{
	f_time_start_etat += TIME_GetDt()
}

// STIMULI ===========================================================================


//if ( f_time_start_etat  > 2.0 || ! ROBOT_Detect_Target( o_fight_target))
if ( ! ROBOT_Detect_Target( o_fight_target))
{
	AI_TrackCurChangeNow("PNJ_MR_ETAT_Move")
}

if ( o_paf_actor)
{
	// Mode Paf
	AI_TrackCurChangeNow("PNJ_MR_ETAT_Paf")	
}

if ( f_time_start_etat >= Cf_DelaiCharge)
{
	AI_TrackCurChangeNow("PNJ_MR_ETAT_Attaque")
}



// COMPORTEMENT ===========================================================================


